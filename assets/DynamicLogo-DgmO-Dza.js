var V=Object.defineProperty;var N=(g,h,d)=>h in g?V(g,h,{enumerable:!0,configurable:!0,writable:!0,value:d}):g[h]=d;var a=(g,h,d)=>(N(g,typeof h!="symbol"?h+"":h,d),d);import{q as z,ba as F,r as w,E as H,ae as O,y as T,z as U,V as $}from"./index-CnjAwGzq.js";import{a as j,b as G,_ as J}from"./caiyunapp-qq9SuBtY.js";const K={class:"canvas-container"},y=400,_=400,X=20,Q=40,b=.95,Z=z({__name:"DynamicLogo",setup(g){class h{constructor(e,o,i,t){a(this,"x");a(this,"y");a(this,"totalX");a(this,"totalY");a(this,"mx");a(this,"my");a(this,"vx");a(this,"vy");a(this,"time");a(this,"r");a(this,"color");a(this,"opacity");this.x=Math.random()*y>>0,this.y=Math.random()*_>>0,this.totalX=e,this.totalY=o,this.time=i,this.r=1.2,this.color=[...t],this.opacity=0}draw(){f.value.fillStyle=`rgba(${this.color.toString()})`,f.value.fillRect(this.x,this.y,this.r*2,this.r*2),f.value.fill()}update(e,o){if(this.mx=this.totalX-this.x,this.my=this.totalY-this.y,this.vx=this.mx/this.time,this.vy=this.my/this.time,e&&o){let i=e-this.x,t=o-this.y,c=Math.sqrt(i**2+t**2),s=Q/c;s=s>7?7:s;let l=Math.atan2(t,i),r=Math.cos(l),m=Math.sin(l),v=r*s*-b,u=m*s*-b;this.vx+=v,this.vy+=u}this.x+=this.vx,this.y+=this.vy,this.opacity<1&&(this.opacity+=R)}change(e,o,i){this.totalX=e,this.totalY=o,this.color=[...i]}}class d{constructor(e,o){a(this,"src");a(this,"name");a(this,"particleData");this.src=e,this.name=o,this.particleData=[];let i=new Image;i.crossOrigin="",i.src=e,i.onload=()=>{const t=document.createElement("canvas"),c=t.getContext("2d"),s=y,l=~~(y*(i.height/i.width));t.width=s,t.height=l,c==null||c.drawImage(i,0,0,s,l);const r=c==null?void 0:c.getImageData(0,0,s,l).data;c==null||c.clearRect(0,0,y,_);for(let m=0;m<l;m+=5)for(let v=0;v<s;v+=5){const u=(v+m*s)*4,L=r[u],k=r[u+1],M=r[u+2],S=r[u+3];if(L+k+M+S>=100){const q=new h(v,m,X,[L,k,M,S]);this.particleData.push(q)}}}}}class B{constructor(e){a(this,"canvasEle");a(this,"ctx");a(this,"width");a(this,"height");a(this,"ParticleArr");a(this,"mouseX");a(this,"mouseY");this.canvasEle=e,this.ctx=e.getContext("2d"),this.width=e.width,this.height=e.height,this.ParticleArr=[],this.canvasEle.addEventListener("mousemove",o=>{const{left:i,top:t}=this.canvasEle.getBoundingClientRect(),{clientX:c,clientY:s}=o;this.mouseX=c-i,this.mouseY=s-t}),this.canvasEle.onmouseleave=()=>{this.mouseX=0,this.mouseY=0}}changeImg(e){if(this.ParticleArr.length){let o=e.particleData,i=o.length,t=this.ParticleArr,c=t.length;for(let l=0;l<i;l++){const{totalX:r,totalY:m,color:v}=o[l];t[l]?t[l].change(r,m,v):t[l]=new h(r,m,X,v)}i<c&&(this.ParticleArr=t.splice(0,i)),t=this.ParticleArr;let s=t.length;for(;s;){let l=~~(Math.random()*s--),r=t[l],{totalX:m,totalY:v,color:u}=r;r.totalX=t[s].totalX,r.totalY=t[s].totalY,r.color=t[s].color,t[s].totalX=m,t[s].totalY=v,t[s].color=u}}else this.ParticleArr=e.particleData.map(o=>new h(o.totalX,o.totalY,X,o.color))}drawCanvas(){this.ctx.clearRect(0,0,this.width,this.height),this.ParticleArr.forEach(e=>{e.update(this.mouseX,this.mouseY),e.draw()}),window.requestAnimationFrame(()=>this.drawCanvas())}}const C=F(),A=C.getBlackPic(),D=C.getWhitePic();let Y={};const p=w(null),f=w(null),x=w(),P=w(""),R=1/X;for(let n in A)Y[n]=new d(A[n],n);for(let n in D)new d(D[n],n);const E=async()=>{const{rectangle:n}=await j(),{result:e}=await G(n.split(";")[0]);return e.realtime.skycon},I=w(),W=()=>{I.value=setInterval(async()=>{let n=await E();P.value!==n&&(x.value.changeImg(Y[n]),P.value=n)},36e5)};return H(async()=>{p.value&&(f.value=p.value.getContext("2d"),x.value=new B(p.value),x.value.drawCanvas()),P.value=await E(),x.value.changeImg(Y[P.value]),W()}),O(()=>{clearInterval(I.value),I.value=null}),(n,e)=>(T(),U("div",K,[$("canvas",{ref_key:"canvas",ref:p,width:y,height:_},null,512)]))}}),it=J(Z,[["__scopeId","data-v-d81ed656"]]);export{it as D};
